<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil de Ezio Auditore</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@400;500;600;700&display=swap');

        :root {
            --color-primary: #8C4B4B;
            --color-secondary: #B8860B;
            --color-background: #F0EAD6;
            --color-card: #FFFFFF;
            --color-text: #2D2D2D;
            --color-text-light: #5A5A5A;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-background);
            background-image: linear-gradient(to bottom right, #f0ead6, #e6dace);
            background-attachment: fixed;
        }
        .title-font {
            font-family: 'Cinzel', serif;
        }
        .profile-container {
            max-width: 800px;
            margin: 2rem auto;
            background-color: var(--color-card);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            color: var(--color-text);
        }
        .profile-header {
            text-align: center;
        }
        .profile-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 4px solid var(--color-card);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: -75px;
            position: relative;
            z-index: 10;
        }
        .cover-photo {
            width: 100%;
            height: 200px;
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://stevivor.com/wp-content/uploads/2016/08/ezio.webp') no-repeat center center;
            background-size: cover;
            border-radius: 12px 12px 0 0;
        }
        .info-card {
            background-color: #f9fafb;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        .post-card {
            background-color: var(--color-card);
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        .like-button {
            transition: all 0.3s ease;
        }
        .like-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* Styles pour la modale d'image */
        .image-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .image-modal-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
        }
        .image-modal-content img {
            display: block;
            width: auto;
            max-width: 100%;
            max-height: 100%;
            margin: auto;
        }
        .image-modal-close {
            position: absolute;
            top: 10px;
            right: 25px;
            color: #fff;
            font-size: 35px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
        }
        .image-modal-close:hover {
            color: #bbb;
        }
    </style>
</head>
<body>

<div class="profile-container">
    <!-- ID de l'utilisateur -->
    <div class="text-xs text-right text-gray-400">ID de l'utilisateur : <span id="user-id">Chargement...</span></div>
    
    <!-- Photo de couverture et de profil -->
    <div class="profile-header">
        <div class="cover-photo cursor-pointer" onclick="openImageModal('https://stevivor.com/wp-content/uploads/2016/08/ezio.webp')"></div>
        <img class="profile-image mx-auto object-cover cursor-pointer" src="https://imagedelivery.net/LBWXYQ-XnKSYxbZ-NuYGqQ/6135f9ed-fd26-4676-544c-0ed43c0e0700/avatarhd" alt="Photo de profil d'Ezio Auditore" onclick="openImageModal(this.src)">
        <h1 class="text-3xl font-bold mt-4 text-gray-800 title-font">Ezio Auditore da Firenze</h1>
        <p class="text-gray-500 mt-2">"Rien n'est vrai, tout est permis."</p>
    </div>

    <!-- Section J'aime -->
    <div class="flex justify-center mt-6 items-center">
        <button id="like-button" class="like-button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-6 rounded-full shadow-lg transition duration-300 transform">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block -mt-1 mr-2" viewBox="0 0 20 20" fill="currentColor">
              <path d="M2 10.5a.5.5 0 01.5-.5h1.284A.5.5 0 014.28 10h1.44a.5.5 0 01.496.46l.72 4.319a.5.5 0 01-.497.541H6.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 019.22 10.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H13.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 0115.22 8.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H18.5a.5.5 0 01-.5-.5V8.5a.5.5 0 01.5-.5H18a.5.5 0 01.5-.5z"/>
            </svg>
            J'aime
        </button>
        <span id="like-count" class="ml-4 text-xl font-bold text-gray-700">0</span>
    </div>

    <!-- Section À propos -->
    <div class="info-card">
        <h2 class="text-xl font-semibold text-gray-700">À propos</h2>
        <p class="mt-2 text-gray-600">Un homme de la Renaissance. J'ai eu une vie bien remplie, entre les arts, la famille... et les affaires qui se règlent discrètement depuis les toits. Maître Assassin, pour le bien de l'humanité.</p>
        <ul class="mt-4 text-gray-600 space-y-2">
            <li><span class="font-medium text-gray-700">Ville actuelle :</span> Florence, Italie</li>
            <li><span class="font-medium text-gray-700">Situation amoureuse :</span> Marié à Sofia Sartor</li>
            <li><span class="font-medium text-gray-700">Travail :</span> Maître Assassin</li>
        </ul>
    </div>

    <!-- Section Photos -->
    <div class="info-card">
        <h2 class="text-xl font-semibold text-gray-700">Photos</h2>
        <div class="grid grid-cols-2 gap-4 mt-4">
            <img class="rounded-lg shadow-md w-full h-auto object-cover cursor-pointer" src="https://image.noelshack.com/fichiers/2025/37/6/1757729385-unnamed.jpg" alt="Photo d'Ezio sur un belvédère" onclick="openImageModal(this.src)">
            <img class="rounded-lg shadow-md w-full h-auto object-cover cursor-pointer" src="https://image.noelshack.com/fichiers/2025/37/6/1757730027-unnamed-1.jpg" alt="Photo d'Ezio avec Leonardo da Vinci" onclick="openImageModal(this.src)">
        </div>
    </div>

    <!-- Section Publications -->
    <div class="post-card">
        <h2 class="text-xl font-semibold text-gray-700">Publications récentes</h2>
        
        <!-- Publication 1 -->
        <div class="border-b pb-4 mb-4">
            <p class="text-gray-500 text-sm">Il y a 5 heures</p>
            <p class="mt-2 text-gray-800">"Les toits de Florence offrent la meilleure perspective. Il faut juste faire attention où on met les pieds. Certains ont la tête un peu dure... et tombent plus vite que prévu."</p>
            <div class="flex items-center mt-2">
                <button id="post-like-button-1" class="post-like-button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform" onclick="handlePostLike('post-1')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block -mt-1 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 10.5a.5.5 0 01.5-.5h1.284A.5.5 0 014.28 10h1.44a.5.5 0 01.496.46l.72 4.319a.5.5 0 01-.497.541H6.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 019.22 10.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H13.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 0115.22 8.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H18.5a.5.5 0 01-.5-.5V8.5a.5.5 0 01.5-.5H18a.5.5 0 01.5-.5z"/>
                    </svg>
                    J'aime
                </button>
                <span id="post-like-count-1" class="ml-2 text-sm text-gray-700">0</span>
                <button onclick="toggleComments('post-1')" class="ml-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform">
                    Commentaires (<span id="comment-count-1">0</span>)
                </button>
            </div>
            <!-- Section commentaires -->
            <div id="comments-section-post-1" class="hidden mt-4 p-3 bg-gray-100 rounded-lg">
                <h3 class="font-semibold text-gray-700 text-sm mb-2">Commentaires</h3>
                <div id="comments-container-post-1" class="text-sm text-gray-600 space-y-2"></div>
                <form class="mt-4" onsubmit="handleCommentSubmit(event, 'post-1')">
                    <input type="text" class="w-full p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" placeholder="Votre pseudo" required>
                    <textarea class="w-full mt-2 p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" rows="2" placeholder="Écrivez un commentaire..." required></textarea>
                    <button type="submit" class="mt-2 w-full bg-yellow-700 hover:bg-yellow-800 text-white text-sm font-bold py-2 px-4 rounded-md transition duration-300">
                        Envoyer
                    </button>
                </form>
            </div>
        </div>
        
        <!-- Publication 2 -->
        <div class="border-b pb-4 mb-4">
            <p class="text-gray-500 text-sm">Hier</p>
            <p class="mt-2 text-gray-800">"Je viens de terminer une réunion avec Leonardo. Un génie, mais il a une fâcheuse tendance à vouloir créer des machines volantes. Je lui ai dit que mes pieds étaient plus fiables."</p>
            <div class="flex items-center mt-2">
                <button id="post-like-button-2" class="post-like-button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform" onclick="handlePostLike('post-2')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block -mt-1 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 10.5a.5.5 0 01.5-.5h1.284A.5.5 0 014.28 10h1.44a.5.5 0 01.496.46l.72 4.319a.5.5 0 01-.497.541H6.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 019.22 10.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H13.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 0115.22 8.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H18.5a.5.5 0 01-.5-.5V8.5a.5.5 0 01.5-.5H18a.5.5 0 01.5-.5z"/>
                    </svg>
                    J'aime
                </button>
                <span id="post-like-count-2" class="ml-2 text-sm text-gray-700">0</span>
                <button onclick="toggleComments('post-2')" class="ml-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform">
                    Commentaires (<span id="comment-count-2">0</span>)
                </button>
            </div>
            <!-- Section commentaires -->
            <div id="comments-section-post-2" class="hidden mt-4 p-3 bg-gray-100 rounded-lg">
                <h3 class="font-semibold text-gray-700 text-sm mb-2">Commentaires</h3>
                <div id="comments-container-post-2" class="text-sm text-gray-600 space-y-2"></div>
                <form class="mt-4" onsubmit="handleCommentSubmit(event, 'post-2')">
                    <input type="text" class="w-full p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" placeholder="Votre pseudo" required>
                    <textarea class="w-full mt-2 p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" rows="2" placeholder="Écrivez un commentaire..." required></textarea>
                    <button type="submit" class="mt-2 w-full bg-yellow-700 hover:bg-yellow-800 text-white text-sm font-bold py-2 px-4 rounded-md transition duration-300">
                        Envoyer
                    </button>
                </form>
            </div>
        </div>
        
        <!-- Publication 3 -->
        <div>
            <p class="text-gray-500 text-sm">Il y a 2 jours</p>
            <p class="mt-2 text-gray-800">"On m'a demandé quel était mon plus grand secret. J'ai répondu : l'entraînement, la discrétion, et ne jamais, au grand jamais, oublier de glisser sa lame secrète."</p>
            <div class="flex items-center mt-2">
                <button id="post-like-button-3" class="post-like-button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform" onclick="handlePostLike('post-3')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block -mt-1 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 10.5a.5.5 0 01.5-.5h1.284A.5.5 0 014.28 10h1.44a.5.5 0 01.496.46l.72 4.319a.5.5 0 01-.497.541H6.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 019.22 10.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H13.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 0115.22 8.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H18.5a.5.5 0 01-.5-.5V8.5a.5.5 0 01.5-.5H18a.5.5 0 01.5-.5z"/>
                    </svg>
                    J'aime
                </button>
                <span id="post-like-count-3" class="ml-2 text-sm text-gray-700">0</span>
                <button onclick="toggleComments('post-3')" class="ml-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform">
                    Commentaires (<span id="comment-count-3">0</span>)
                </button>
            </div>
            <!-- Section commentaires -->
            <div id="comments-section-post-3" class="hidden mt-4 p-3 bg-gray-100 rounded-lg">
                <h3 class="font-semibold text-gray-700 text-sm mb-2">Commentaires</h3>
                <div id="comments-container-post-3" class="text-sm text-gray-600 space-y-2"></div>
                <form class="mt-4" onsubmit="handleCommentSubmit(event, 'post-3')">
                    <input type="text" class="w-full p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" placeholder="Votre pseudo" required>
                    <textarea class="w-full mt-2 p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" rows="2" placeholder="Écrivez un commentaire..." required></textarea>
                    <button type="submit" class="mt-2 w-full bg-yellow-700 hover:bg-yellow-800 text-white text-sm font-bold py-2 px-4 rounded-md transition duration-300">
                        Envoyer
                    </button>
                </form>
            </div>
        </div>
        
        <!-- Nouvelle Publication 1 -->
        <div class="border-b pb-4 mb-4">
            <p class="text-gray-500 text-sm">Il y a 4 jours</p>
            <p class="mt-2 text-gray-800">"Ma vie a commencé avec la perte de ma famille et la soif de vengeance. J'ai compris avec le temps que la vengeance n'est pas un but. C'est le chemin qui nous mène à la justice."</p>
            <div class="flex items-center mt-2">
                <button id="post-like-button-4" class="post-like-button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform" onclick="handlePostLike('post-4')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block -mt-1 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 10.5a.5.5 0 01.5-.5h1.284A.5.5 0 014.28 10h1.44a.5.5 0 01.496.46l.72 4.319a.5.5 0 01-.497.541H6.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 019.22 10.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H13.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 0115.22 8.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H18.5a.5.5 0 01-.5-.5V8.5a.5.5 0 01.5-.5H18a.5.5 0 01.5-.5z"/>
                    </svg>
                    J'aime
                </button>
                <span id="post-like-count-4" class="ml-2 text-sm text-gray-700">0</span>
                <button onclick="toggleComments('post-4')" class="ml-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform">
                    Commentaires (<span id="comment-count-4">0</span>)
                </button>
            </div>
            <!-- Section commentaires -->
            <div id="comments-section-post-4" class="hidden mt-4 p-3 bg-gray-100 rounded-lg">
                <h3 class="font-semibold text-gray-700 text-sm mb-2">Commentaires</h3>
                <div id="comments-container-post-4" class="text-sm text-gray-600 space-y-2"></div>
                <form class="mt-4" onsubmit="handleCommentSubmit(event, 'post-4')">
                    <input type="text" class="w-full p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" placeholder="Votre pseudo" required>
                    <textarea class="w-full mt-2 p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" rows="2" placeholder="Écrivez un commentaire..." required></textarea>
                    <button type="submit" class="mt-2 w-full bg-yellow-700 hover:bg-yellow-800 text-white text-sm font-bold py-2 px-4 rounded-md transition duration-300">
                        Envoyer
                    </button>
                </form>
            </div>
        </div>

        <!-- Nouvelle Publication 2 -->
        <div class="border-b pb-4 mb-4">
            <p class="text-gray-500 text-sm">Il y a une semaine</p>
            <p class="mt-2 text-gray-800">"Ce n'est pas parce qu'un homme est riche qu'il a du goût. J'ai vu des robes qui valaient des milliers de florins, mais qui feraient fuir un moine. Et j'ai vu des assassins qui valaient leur pesant d'or."</p>
            <div class="flex items-center mt-2">
                <button id="post-like-button-5" class="post-like-button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform" onclick="handlePostLike('post-5')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block -mt-1 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 10.5a.5.5 0 01.5-.5h1.284A.5.5 0 014.28 10h1.44a.5.5 0 01.496.541l.263 2.112A.5.5 0 019.22 10.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H13.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 0115.22 8.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H18.5a.5.5 0 01-.5-.5V8.5a.5.5 0 01.5-.5H18a.5.5 0 01.5-.5z"/>
                    </svg>
                    J'aime
                </button>
                <span id="post-like-count-5" class="ml-2 text-sm text-gray-700">0</span>
                <button onclick="toggleComments('post-5')" class="ml-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform">
                    Commentaires (<span id="comment-count-5">0</span>)
                </button>
            </div>
            <!-- Section commentaires -->
            <div id="comments-section-post-5" class="hidden mt-4 p-3 bg-gray-100 rounded-lg">
                <h3 class="font-semibold text-gray-700 text-sm mb-2">Commentaires</h3>
                <div id="comments-container-post-5" class="text-sm text-gray-600 space-y-2"></div>
                <form class="mt-4" onsubmit="handleCommentSubmit(event, 'post-5')">
                    <input type="text" class="w-full p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" placeholder="Votre pseudo" required>
                    <textarea class="w-full mt-2 p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" rows="2" placeholder="Écrivez un commentaire..." required></textarea>
                    <button type="submit" class="mt-2 w-full bg-yellow-700 hover:bg-yellow-800 text-white text-sm font-bold py-2 px-4 rounded-md transition duration-300">
                        Envoyer
                    </button>
                </form>
            </div>
        </div>

        <!-- Nouvelle Publication 3 -->
        <div>
            <p class="text-gray-500 text-sm">Il y a deux semaines</p>
            <p class="mt-2 text-gray-800">"La famille n'est pas un choix, c'est un cadeau. Chérissez-la comme la plus précieuse des reliques. Et si vous la perdez, ne vous reposez jamais avant d'avoir honoré leur mémoire."</p>
            <div class="flex items-center mt-2">
                <button id="post-like-button-6" class="post-like-button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform" onclick="handlePostLike('post-6')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block -mt-1 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 10.5a.5.5 0 01.5-.5h1.284A.5.5 0 014.28 10h1.44a.5.5 0 01.496.46l.72 4.319a.5.5 0 01-.497.541H6.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 019.22 10.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H13.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 0115.22 8.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H18.5a.5.5 0 01-.5-.5V8.5a.5.5 0 01.5-.5H18a.5.5 0 01.5-.5z"/>
                    </svg>
                    J'aime
                </button>
                <span id="post-like-count-6" class="ml-2 text-sm text-gray-700">0</span>
                <button onclick="toggleComments('post-6')" class="ml-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform">
                    Commentaires (<span id="comment-count-6">0</span>)
                </button>
            </div>
            <!-- Section commentaires -->
            <div id="comments-section-post-6" class="hidden mt-4 p-3 bg-gray-100 rounded-lg">
                <h3 class="font-semibold text-gray-700 text-sm mb-2">Commentaires</h3>
                <div id="comments-container-post-6" class="text-sm text-gray-600 space-y-2"></div>
                <form class="mt-4" onsubmit="handleCommentSubmit(event, 'post-6')">
                    <input type="text" class="w-full p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" placeholder="Votre pseudo" required>
                    <textarea class="w-full mt-2 p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" rows="2" placeholder="Écrivez un commentaire..." required></textarea>
                    <button type="submit" class="mt-2 w-full bg-yellow-700 hover:bg-yellow-800 text-white text-sm font-bold py-2 px-4 rounded-md transition duration-300">
                        Envoyer
                    </button>
                </form>
            </div>
        </div>

        <!-- Nouvelle publication 4 -->
        <div class="border-b pb-4 mb-4">
            <p class="text-gray-500 text-sm">Il y a 3 semaines</p>
            <p class="mt-2 text-gray-800">"Rome n'a pas été construite en un jour, et mon ascension ne l'a pas été non plus. Chaque saut, chaque lame, chaque défi, tout cela forge l'héritage que je laisse derrière moi. J'ai un long chemin devant moi, mais je ne serai jamais seul."</p>
            <div class="flex items-center mt-2">
                <button id="post-like-button-7" class="post-like-button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform" onclick="handlePostLike('post-7')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block -mt-1 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 10.5a.5.5 0 01.5-.5h1.284A.5.5 0 014.28 10h1.44a.5.5 0 01.496.541l.263 2.112A.5.5 0 019.22 10.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H13.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 0115.22 8.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H18.5a.5.5 0 01-.5-.5V8.5a.5.5 0 01.5-.5H18a.5.5 0 01.5-.5z"/>
                    </svg>
                    J'aime
                </button>
                <span id="post-like-count-7" class="ml-2 text-sm text-gray-700">0</span>
                <button onclick="toggleComments('post-7')" class="ml-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform">
                    Commentaires (<span id="comment-count-7">0</span>)
                </button>
            </div>
            <!-- Section commentaires -->
            <div id="comments-section-post-7" class="hidden mt-4 p-3 bg-gray-100 rounded-lg">
                <h3 class="font-semibold text-gray-700 text-sm mb-2">Commentaires</h3>
                <div id="comments-container-post-7" class="text-sm text-gray-600 space-y-2"></div>
                <form class="mt-4" onsubmit="handleCommentSubmit(event, 'post-7')">
                    <input type="text" class="w-full p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" placeholder="Votre pseudo" required>
                    <textarea class="w-full mt-2 p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" rows="2" placeholder="Écrivez un commentaire..." required></textarea>
                    <button type="submit" class="mt-2 w-full bg-yellow-700 hover:bg-yellow-800 text-white text-sm font-bold py-2 px-4 rounded-md transition duration-300">
                        Envoyer
                    </button>
                </form>
            </div>
        </div>

        <!-- Nouvelle publication 5 -->
        <div class="border-b pb-4 mb-4">
            <p class="text-gray-500 text-sm">Il y a 1 mois</p>
            <p class="mt-2 text-gray-800">"À Rome, les gens pensent que la vie est une fête. Ils sont si occupés par leurs affaires qu'ils ne voient pas les ombres qui les guettent. Heureusement que nous sommes là pour leur rappeler que la fête est finie."</p>
            <div class="flex items-center mt-2">
                <button id="post-like-button-8" class="post-like-button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform" onclick="handlePostLike('post-8')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block -mt-1 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 10.5a.5.5 0 01.5-.5h1.284A.5.5 0 014.28 10h1.44a.5.5 0 01.496.541l.263 2.112A.5.5 0 019.22 10.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H13.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 0115.22 8.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H18.5a.5.5 0 01-.5-.5V8.5a.5.5 0 01.5-.5H18a.5.5 0 01.5-.5z"/>
                    </svg>
                    J'aime
                </button>
                <span id="post-like-count-8" class="ml-2 text-sm text-gray-700">0</span>
                <button onclick="toggleComments('post-8')" class="ml-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform">
                    Commentaires (<span id="comment-count-8">0</span>)
                </button>
            </div>
            <!-- Section commentaires -->
            <div id="comments-section-post-8" class="hidden mt-4 p-3 bg-gray-100 rounded-lg">
                <h3 class="font-semibold text-gray-700 text-sm mb-2">Commentaires</h3>
                <div id="comments-container-post-8" class="text-sm text-gray-600 space-y-2"></div>
                <form class="mt-4" onsubmit="handleCommentSubmit(event, 'post-8')">
                    <input type="text" class="w-full p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" placeholder="Votre pseudo" required>
                    <textarea class="w-full mt-2 p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" rows="2" placeholder="Écrivez un commentaire..." required></textarea>
                    <button type="submit" class="mt-2 w-full bg-yellow-700 hover:bg-yellow-800 text-white text-sm font-bold py-2 px-4 rounded-md transition duration-300">
                        Envoyer
                    </button>
                </form>
            </div>
        </div>

        <!-- Nouvelle publication 6 -->
        <div>
            <p class="text-gray-500 text-sm">Il y a 6 semaines</p>
            <p class="mt-2 text-gray-800">"J'ai vu la vie de la plus haute tour de Florence et j'ai vu la mort dans les ruelles les plus sombres de Venise. Mais le plus grand spectacle que j'ai vu, c'est de voir un homme libre se battre pour ses convictions. C'est un spectacle qui ne se refuse pas."</p>
            <div class="flex items-center mt-2">
                <button id="post-like-button-9" class="post-like-button bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform" onclick="handlePostLike('post-9')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block -mt-1 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 10.5a.5.5 0 01.5-.5h1.284A.5.5 0 014.28 10h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H6.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 019.22 10.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H13.5a.5.5 0 01-.5-.5v-4zm5-2a.5.5 0 01.5-.5h1.72a.5.5 0 01.496.541l.263 2.112A.5.5 0 0115.22 8.5h1.44a.5.5 0 01.496.541l.72 4.319a.5.5 0 01-.497.541H18.5a.5.5 0 01-.5-.5V8.5a.5.5 0 01.5-.5H18a.5.5 0 01.5-.5z"/>
                    </svg>
                    J'aime
                </button>
                <span id="post-like-count-9" class="ml-2 text-sm text-gray-700">0</span>
                <button onclick="toggleComments('post-9')" class="ml-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-1 px-3 text-sm rounded-full shadow-lg transition duration-300 transform">
                    Commentaires (<span id="comment-count-9">0</span>)
                </button>
            </div>
            <!-- Section commentaires -->
            <div id="comments-section-post-9" class="hidden mt-4 p-3 bg-gray-100 rounded-lg">
                <h3 class="font-semibold text-gray-700 text-sm mb-2">Commentaires</h3>
                <div id="comments-container-post-9" class="text-sm text-gray-600 space-y-2"></div>
                <form class="mt-4" onsubmit="handleCommentSubmit(event, 'post-9')">
                    <input type="text" class="w-full p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" placeholder="Votre pseudo" required>
                    <textarea class="w-full mt-2 p-2 text-sm rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-700" rows="2" placeholder="Écrivez un commentaire..." required></textarea>
                    <button type="submit" class="mt-2 w-full bg-yellow-700 hover:bg-yellow-800 text-white text-sm font-bold py-2 px-4 rounded-md transition duration-300">
                        Envoyer
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Modale d'image pour l'affichage en grand -->
<div id="imageModal" class="image-modal-overlay">
    <span class="image-modal-close" onclick="closeImageModal()">&times;</span>
    <div class="image-modal-content">
        <img id="enlargedImage" src="" alt="Image en grand">
    </div>
</div>

<!-- Firebase et le code JavaScript pour le système de "j'aime" et des commentaires -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc, onSnapshot, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
    import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
    const firebaseConfig = JSON.parse(__firebase_config);
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);
    const likesDocRef = doc(db, 'artifacts', appId, 'public/data/likes', 'ezio');

    let userId = null;
    const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
    const postIds = ['post-1', 'post-2', 'post-3', 'post-4', 'post-5', 'post-6', 'post-7', 'post-8', 'post-9'];

    window.onload = function() {
        // Authentification de l'utilisateur
        if (initialAuthToken) {
            signInWithCustomToken(auth, initialAuthToken).catch(console.error);
        } else {
            signInAnonymously(auth).catch(console.error);
        }

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                document.getElementById('user-id').textContent = userId;
                
                // Écouter les changements en temps réel sur le document des "j'aime" du profil
                onSnapshot(likesDocRef, (docSnap) => {
                    const likeCountSpan = document.getElementById('like-count');
                    if (likeCountSpan) {
                        const likesData = docSnap.exists() ? docSnap.data() : { count: 0 };
                        likeCountSpan.textContent = likesData.count;
                    }
                });
                
                const likeButton = document.getElementById('like-button');
                const userLikedRef = doc(db, 'artifacts', appId, `users/${userId}/liked_profiles/ezio`);
                const userLikedDoc = await getDoc(userLikedRef);

                if (userLikedDoc.exists()) {
                    likeButton.textContent = 'Aimé ! ❤️';
                    likeButton.classList.remove('bg-gray-300', 'hover:bg-gray-400');
                    likeButton.classList.add('bg-pink-500', 'hover:bg-pink-600');
                }

                likeButton.addEventListener('click', async () => {
                    const likedDoc = await getDoc(userLikedRef);
                    if (likedDoc.exists()) {
                        likeButton.textContent = 'Déjà aimé !';
                        return;
                    }
                    await setDoc(userLikedRef, { likedAt: new Date() });
                    
                    let currentCount = 0;
                    const likesDoc = await getDoc(likesDocRef);
                    if (likesDoc.exists()) {
                        currentCount = likesDoc.data().count;
                    }
                    await setDoc(likesDocRef, { count: currentCount + 1 });
                    
                    likeButton.textContent = 'Aimé ! ❤️';
                    likeButton.classList.remove('bg-gray-300', 'hover:bg-gray-400');
                    likeButton.classList.add('bg-pink-500', 'hover:bg-pink-600');
                });

                // Écouter les changements pour chaque publication
                postIds.forEach(postId => {
                    // Likes des publications
                    const postLikesDocRef = doc(db, 'artifacts', appId, `public/data/post_likes/${postId}`);
                    onSnapshot(postLikesDocRef, (docSnap) => {
                        const postLikeCountSpan = document.getElementById(`post-like-count-${postId.split('-')[1]}`);
                        if (postLikeCountSpan) {
                            const likesData = docSnap.exists() ? docSnap.data() : { count: 0 };
                            postLikeCountSpan.textContent = likesData.count;
                        }
                    });

                    // Commentaires des publications
                    const commentsCollectionRef = collection(db, 'artifacts', appId, `public/data/post_comments/${postId}/comments`);
                    onSnapshot(commentsCollectionRef, (querySnapshot) => {
                        const commentsContainer = document.getElementById(`comments-container-post-${postId.split('-')[1]}`);
                        const commentCountSpan = document.getElementById(`comment-count-${postId.split('-')[1]}`);
                        
                        if (commentsContainer && commentCountSpan) {
                            commentsContainer.innerHTML = '';
                            const comments = [];
                            querySnapshot.forEach((doc) => {
                                comments.push(doc.data());
                            });
                            
                            commentCountSpan.textContent = comments.length;

                            // Tri des commentaires par horodatage (le plus récent en premier)
                            comments.sort((a, b) => {
                              if (!a.timestamp) return 1;
                              if (!b.timestamp) return -1;
                              return b.timestamp.toMillis() - a.timestamp.toMillis();
                            });
                            
                            comments.forEach(comment => {
                                const commentDiv = document.createElement('div');
                                commentDiv.className = 'bg-gray-200 p-2 rounded-md mb-2';
                                commentDiv.innerHTML = `<p class="font-semibold text-xs text-gray-800">${comment.pseudo}</p><p class="mt-1">${comment.text}</p>`;
                                commentsContainer.appendChild(commentDiv);
                            });
                        }
                    });

                    // Mettre à jour les boutons de "j'aime" des publications au chargement
                    const postUserLikedRef = doc(db, 'artifacts', appId, `users/${userId}/liked_posts/${postId}`);
                    getDoc(postUserLikedRef).then(likedDoc => {
                        const postLikeButton = document.getElementById(`post-like-button-${postId.split('-')[1]}`);
                        if(likedDoc.exists() && postLikeButton) {
                            postLikeButton.textContent = 'Aimé ! ❤️';
                            postLikeButton.classList.remove('bg-gray-300', 'hover:bg-gray-400');
                            postLikeButton.classList.add('bg-pink-500', 'hover:bg-pink-600');
                        }
                    });
                });
            }
        });

        // Fonction pour gérer les likes de chaque publication
        window.handlePostLike = async (postId) => {
            const postLikesDocRef = doc(db, 'artifacts', appId, `public/data/post_likes/${postId}`);
            const postUserLikedRef = doc(db, 'artifacts', appId, `users/${userId}/liked_posts/${postId}`);
            const postLikeButton = document.getElementById(`post-like-button-${postId.split('-')[1]}`);

            const likedDoc = await getDoc(postUserLikedRef);
            if (likedDoc.exists()) {
                postLikeButton.textContent = 'Déjà aimé !';
                return;
            }

            await setDoc(postUserLikedRef, { likedAt: new Date() });

            let currentCount = 0;
            const postLikesDoc = await getDoc(postLikesDocRef);
            if (postLikesDoc.exists()) {
                currentCount = postLikesDoc.data().count;
            }
            await setDoc(postLikesDocRef, { count: currentCount + 1 });
            
            postLikeButton.textContent = 'Aimé ! ❤️';
            postLikeButton.classList.remove('bg-gray-300', 'hover:bg-gray-400');
            postLikeButton.classList.add('bg-pink-500', 'hover:bg-pink-600');
        };

        // Fonction pour afficher/masquer le champ de commentaires
        window.toggleComments = (postId) => {
            const commentsSection = document.getElementById(`comments-section-${postId}`);
            if (commentsSection) {
                commentsSection.classList.toggle('hidden');
            }
        };

        // Fonction pour ajouter un commentaire
        window.handleCommentSubmit = async (event, postId) => {
            event.preventDefault();
            const pseudo = event.target.querySelector('input').value.trim();
            const commentText = event.target.querySelector('textarea').value.trim();

            if (commentText.length > 0 && pseudo.length > 0) {
                const commentsCollectionRef = collection(db, 'artifacts', appId, `public/data/post_comments/${postId}/comments`);
                await addDoc(commentsCollectionRef, {
                    userId: userId,
                    pseudo: pseudo,
                    text: commentText,
                    timestamp: serverTimestamp()
                });
                event.target.reset(); // Réinitialiser le formulaire
            }
        };

        // Fonctions pour la modale d'image
        window.openImageModal = function(src) {
            const modal = document.getElementById('imageModal');
            const enlargedImage = document.getElementById('enlargedImage');
            enlargedImage.src = src;
            modal.style.display = 'flex';
        }

        window.closeImageModal = function() {
            const modal = document.getElementById('imageModal');
            modal.style.display = 'none';
        }
    };
</script>

</body>
</html>
